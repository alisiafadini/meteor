<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.1">
<title>meteor.diffmaps API documentation</title>
<meta name="description" content="library for computing difference density maps">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>meteor.diffmaps</code></h1>
</header>
<section id="section-intro">
<p>library for computing difference density maps</p>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="meteor.diffmaps.compute_difference_map"><code class="name flex">
<span>def <span class="ident">compute_difference_map</span></span>(<span>derivative: Map, native: Map) ‑> <a title="meteor.rsmap.Map" href="rsmap.html#meteor.rsmap.Map">Map</a></span>
</code></dt>
<dd>
<div class="desc"><p>Computes amplitude and phase differences between native and derivative structure factor sets.</p>
<p>It converts the amplitude and phase pairs from both the native and derivative structure factor
sets into complex numbers, computes the difference, and then converts the result back
into amplitudes and phases.</p>
<p>If uncertainty columns are provided for both native and derivative data, it also propagates the
uncertainty of the difference in amplitudes.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>derivative</code></strong> :&ensp;<code>Map</code></dt>
<dd>the derivative amplitudes, phases, uncertainties</dd>
<dt><strong><code>native</code></strong> :&ensp;<code>Map</code></dt>
<dd>the native amplitudes, phases, uncertainties</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>diffmap</code></strong> :&ensp;<code>Map</code></dt>
<dd>map corresponding to the complex difference (derivative - native)</dd>
</dl></div>
</dd>
<dt id="meteor.diffmaps.compute_kweighted_difference_map"><code class="name flex">
<span>def <span class="ident">compute_kweighted_difference_map</span></span>(<span>derivative: Map, native: Map, *, k_parameter: float) ‑> <a title="meteor.rsmap.Map" href="rsmap.html#meteor.rsmap.Map">Map</a></span>
</code></dt>
<dd>
<div class="desc"><p>Compute k-weighted derivative - native structure factor map.</p>
<p>This function first computes the standard difference map using <code><a title="meteor.diffmaps.compute_difference_map" href="#meteor.diffmaps.compute_difference_map">compute_difference_map()</a></code>.
Then, it applies k-weighting to the amplitude differences based on the provided <code>k_parameter</code>.</p>
<p>Assumes amplitudes have already been scaled prior to invoking this function.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>derivative</code></strong> :&ensp;<code>Map</code></dt>
<dd>the derivative amplitudes, phases, uncertainties</dd>
<dt><strong><code>native</code></strong> :&ensp;<code>Map</code></dt>
<dd>the native amplitudes, phases, uncertainties</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>diffmap</code></strong> :&ensp;<code>Map</code></dt>
<dd>the k-weighted difference map</dd>
</dl></div>
</dd>
<dt id="meteor.diffmaps.compute_kweights"><code class="name flex">
<span>def <span class="ident">compute_kweights</span></span>(<span>difference_map: Map, *, k_parameter: float) ‑> reciprocalspaceship.dataseries.DataSeries</span>
</code></dt>
<dd>
<div class="desc"><p>Compute weights for each structure factor based on DeltaF and its uncertainty.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>difference_map</code></strong> :&ensp;<code>Map</code></dt>
<dd>A map of structure factor differences (DeltaF).</dd>
<dt><strong><code>k_parameter</code></strong> :&ensp;<code>float</code></dt>
<dd>A scaling factor applied to the squared <code>df</code> values in the weight calculation.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>weights</code></strong> :&ensp;<code>rs.DataSeries</code></dt>
<dd>A series of computed weights, where higher uncertainties and larger differences lead to
lower weights.</dd>
</dl></div>
</dd>
<dt id="meteor.diffmaps.max_negentropy_kweighted_difference_map"><code class="name flex">
<span>def <span class="ident">max_negentropy_kweighted_difference_map</span></span>(<span>derivative: Map, native: Map, *, k_parameter_values_to_scan: np.ndarray | Sequence[float] = array([0.
, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1 ,
0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2 , 0.21,
0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3 , 0.31, 0.32,
0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4 , 0.41, 0.42, 0.43,
0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5 , 0.51, 0.52, 0.53, 0.54,
0.55, 0.56, 0.57, 0.58, 0.59, 0.6 , 0.61, 0.62, 0.63, 0.64, 0.65,
0.66, 0.67, 0.68, 0.69, 0.7 , 0.71, 0.72, 0.73, 0.74, 0.75, 0.76,
0.77, 0.78, 0.79, 0.8 , 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87,
0.88, 0.89, 0.9 , 0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98,
0.99, 1.
])) ‑> reciprocalspaceship.dataset.DataSet</span>
</code></dt>
<dd>
<div class="desc"><p>Compute k-weighted differences between native and derivative amplitudes and phases.</p>
<p>Determines an "optimal" k_parameter, between 0.0 and 1.0, that maximizes the resulting
difference map negentropy. Assumes that scaling has already been applied to the amplitudes
before calling this function.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>derivative</code></strong> :&ensp;<code>Map</code></dt>
<dd>the derivative amplitudes, phases, uncertainties</dd>
<dt><strong><code>native</code></strong> :&ensp;<code>Map</code></dt>
<dd>the native amplitudes, phases, uncertainties</dd>
<dt><strong><code>k_parameter_values_to_scan</code></strong> :&ensp;<code>np.ndarray | Sequence[float]</code></dt>
<dd>The values to scan to optimize the k-weighting parameter, by default is 0.00, 0.01 &hellip; 1.00</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>kweighted_dataset</code></strong> :&ensp;<code>rs.DataSet</code></dt>
<dd>dataset with added columns</dd>
<dt><strong><code>opt_k_parameter</code></strong> :&ensp;<code>float</code></dt>
<dd>optimized k-weighting parameter</dd>
</dl></div>
</dd>
<dt id="meteor.diffmaps.set_common_crystallographic_metadata"><code class="name flex">
<span>def <span class="ident">set_common_crystallographic_metadata</span></span>(<span>map1: Map, map2: Map, *, output: Map) ‑> None</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="meteor" href="index.html">meteor</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="meteor.diffmaps.compute_difference_map" href="#meteor.diffmaps.compute_difference_map">compute_difference_map</a></code></li>
<li><code><a title="meteor.diffmaps.compute_kweighted_difference_map" href="#meteor.diffmaps.compute_kweighted_difference_map">compute_kweighted_difference_map</a></code></li>
<li><code><a title="meteor.diffmaps.compute_kweights" href="#meteor.diffmaps.compute_kweights">compute_kweights</a></code></li>
<li><code><a title="meteor.diffmaps.max_negentropy_kweighted_difference_map" href="#meteor.diffmaps.max_negentropy_kweighted_difference_map">max_negentropy_kweighted_difference_map</a></code></li>
<li><code><a title="meteor.diffmaps.set_common_crystallographic_metadata" href="#meteor.diffmaps.set_common_crystallographic_metadata">set_common_crystallographic_metadata</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
</body>
</html>
